<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>how is the weatehr</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous"> -->
    <link rel="stylesheet" type="text/css" media="screen" href="style.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="bootstrap-grid.css" />
    <script src="js/jquery.js"></script>
</head>
<body>
    <div class="col-lg-12 con">
        <h1 class="col-lg-12"> هوای امروز چطوره؟</h1>
        <div class="col-lg-12 search_box">
            <input type="text" class="col-lg-10 search" placeholder="نام شهر مورد نظر را وارد کنید"> <input type="button" class="search_butt" id = "getIt" onclick = "gettingJSON()">
        </div>

        <div class="col-lg-10 row">
            <div class="items col-lg-3 col-md-4 col-sm-6"> 
                <div class="item">
                    <img src="pics/rad.png">
                    <h2> بابل </h2>
                    <img class="icon" src="pics/temp_icon.png">
                    <h1>15°c</h1>
                    <!-- <i class="fas fa-thermometer-half temp_icon"></i> -->
                    <span>توضیحات بیشتر و یا نمودار مربوط به پیش بینی هوای روز های آینده  </span>
                </div>
            </div>
        </div>
    </div>
</body>
</html>


<script>
    var temp,description;

    $(".con > .row ").html("");
    $(".search").val("");

    function gettingJSON(){
        city = $(".search").val();
        url = "http://api.openweathermap.org/data/2.5/weather?q="+city+"&units=metric&APPID=7ea8f559ec5f1f0899b61c89d728a8b9";
        $.getJSON(url,function (json,status){
            //alert(status);
            var mydata=JSON.stringify(json);
            var weather_data=JSON.parse(mydata);
            temp=Math.round(weather_data.main.temp);
            weather_icon = weather_data.weather[0].icon;
            weather_desc = weather_data.weather[0].description;
            
            console.log(weather_icon,temp);
            console.log(temp);

            items = $("<div>").addClass("items col-lg-3 col-md-4 col-sm-6");
            item = $("<div>").addClass("item");
            im = $("<img>").attr({src: "pics/"+weather_icon+".png"});
            h2 = $("<h2>").html(city);
            h1 = $("<h1>").html(temp+"°c");
            icon = $("<img>").addClass("icon").attr({src: "pics/temp_icon.png"});
            sp = $("<span>").html(weather_desc);

            item.append(im).append(h2).append(icon).append(h1).append(sp);
            items.append(item);
            $(".con > .row.error").removeClass("error").html(" ");
            $(".con > .row ").append(items);
            $(".search").val("");

        }).fail(function() {
        $(".con > .row ").html("");
        $(".search").val("");
        $(".con > .row").addClass("error");
        $(".con > .row.error ").html("شهر مورد نظر یافت نشد.").css({"color":"#fff"});  //404 not found handle
    });    

}

</script>


